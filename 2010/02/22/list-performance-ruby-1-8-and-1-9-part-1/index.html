<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="（本文数据较多，在rss reader里面可能可读性不是很好，可考虑直接在线阅读） 昨天看到pipitu的这篇blog，觉得蛮有意思，文章比较了python和java的list performance，只可惜没有include ruby 1.8和ruby 1.9，不然结论会更有悬念一点，呵呵. 由于无法营造一致的软硬件环境，也不愿意重复pipitu关于python和java部分的工作，这里就只好先">
<meta name="keywords" content="Ruby,Performance">
<meta property="og:type" content="article">
<meta property="og:title" content="List performance: ruby 1.8 and 1.9 (Part 1)">
<meta property="og:url" content="http://yoursite.com/2010/02/22/list-performance-ruby-1-8-and-1-9-part-1/index.html">
<meta property="og:site_name" content="Samson&#39;s Blog">
<meta property="og:description" content="（本文数据较多，在rss reader里面可能可读性不是很好，可考虑直接在线阅读） 昨天看到pipitu的这篇blog，觉得蛮有意思，文章比较了python和java的list performance，只可惜没有include ruby 1.8和ruby 1.9，不然结论会更有悬念一点，呵呵. 由于无法营造一致的软硬件环境，也不愿意重复pipitu关于python和java部分的工作，这里就只好先">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-11-29T07:56:20.405Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="List performance: ruby 1.8 and 1.9 (Part 1)">
<meta name="twitter:description" content="（本文数据较多，在rss reader里面可能可读性不是很好，可考虑直接在线阅读） 昨天看到pipitu的这篇blog，觉得蛮有意思，文章比较了python和java的list performance，只可惜没有include ruby 1.8和ruby 1.9，不然结论会更有悬念一点，呵呵. 由于无法营造一致的软硬件环境，也不愿意重复pipitu关于python和java部分的工作，这里就只好先">






  <link rel="canonical" href="http://yoursite.com/2010/02/22/list-performance-ruby-1-8-and-1-9-part-1/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>List performance: ruby 1.8 and 1.9 (Part 1) | Samson's Blog</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Samson's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

    <a href="https://github.com/samsonw" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2010/02/22/list-performance-ruby-1-8-and-1-9-part-1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Samson Wu">
      <meta itemprop="description" content="天与弗取，反受其咎；时至不行，反受其殃">
      <meta itemprop="image" content="/images/cartoon_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Samson's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">List performance: ruby 1.8 and 1.9 (Part 1)
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2010-02-22 10:47:02" itemprop="dateCreated datePublished" datetime="2010-02-22T10:47:02+08:00">2010-02-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-11-29 15:56:20" itemprop="dateModified" datetime="2018-11-29T15:56:20+08:00">2018-11-29</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Ruby/" itemprop="url" rel="index"><span itemprop="name">Ruby</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Ruby/Technique/" itemprop="url" rel="index"><span itemprop="name">Technique</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Symbols count in article: </span>
                
                <span title="Symbols count in article">10k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">17 mins.</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>（本文数据较多，在rss reader里面可能可读性不是很好，可考虑直接<a href="http://blog.samsonis.me/2010/02/list-performance-ruby-1-8-and-1-9-part-1/" target="_blank" rel="noopener">在线</a>阅读） 昨天看到<a href="http://pipitu.org/" target="_blank" rel="noopener">pipitu</a>的<a href="http://pipitu.org/2010/02/20/list-performance-python-vs-java/" target="_blank" rel="noopener">这篇blog</a>，觉得蛮有意思，文章比较了python和java的list performance，只可惜没有include ruby 1.8和ruby 1.9，不然结论会更有悬念一点，呵呵. 由于无法营造一致的软硬件环境，也不愿意重复pipitu关于python和java部分的工作，这里就只好先简单benchmark（如果可以算是的话）一下ruby 1.8和1.9里的list (array) performance了，也许pipitu以后有空更新include ruby也说不定：） 先看一下我们用的ruby的版本： [cc lang=”bash”] $ ruby -v ruby 1.8.7 (2009-06-12 patchlevel 174) [i686-darwin9] [/cc] [cc lang=”bash”] $ ruby1.9 -v ruby 1.9.1p376 (2009-12-07 revision 26041) [i386-darwin9] [/cc] 还有os： [cc lang=”bash” nowrap=”false”] $ uname -a Darwin macbook.local 9.8.0 Darwin Kernel Version 9.8.0: Wed Jul 15 16:55:01 PDT 2009; root:xnu-1228.15.4~1/RELEASE_I386 i386 [/cc] benchmark的方法和pipitu的python sample类似，就是往空的list里面循环n次append，由于循环也被引入，其performance也值得考虑，因为众所周知ruby里面做一件事犹如孔乙己的茴字写法一样有n种办法，其performance也各不一样，说不定pipitu以后会和python, java进行横向，咱还是挑相对快一点的好～ 不过话说回来，再怎么的精挑细选，java那边还是基本没有悬念，真正有悬念的，我们都心知肚明，呵呵。 所以真正运动之前先来点热身运动，看看哪个循环在我这相对要快： [cc lang=”ruby”] require ‘benchmark’ n = ARGV.empty? ? 10 <strong> 6 : 10 </strong> ARGV[0].to_i puts “n=#{n}” Benchmark.bmbm do |b| b.report(“for:”) { for i in 1..n ; a = “0”; end } b.report(“times:”) { n.times do ; a = “0”; end } b.report(“upto:”) { 1.upto(n) do ; a = “0”; end } b.report(“downto:”) { n.downto(1) do ; a = “0”; end } end [/cc] 以上是我所想到的比较常见的4种茴字写法，程序默认取n=10^6进行循环，也可以接受一个作为幂指数的命令行参数，Benchmark的bmbm方法会先dry run一遍所有test作为rehearsal，等memory和garbage collection的状态相对stable了以后才进行真正的benchmark，这样先运行和后运行的report会相对公平一点。 默认运行（ n=10^6 ）的结果如下： [cc lang=”bash”] n=1000000 Rehearsal ——————————————- for: 0.310000 0.000000 0.310000 ( 0.313392) times: 0.290000 0.000000 0.290000 ( 0.297268) upto: 0.300000 0.000000 0.300000 ( 0.300311) downto: 0.310000 0.000000 0.310000 ( 0.304146) ———————————- total: 1.210000sec user system total real for: 0.310000 0.000000 0.310000 ( 0.313129) times: 0.290000 0.000000 0.290000 ( 0.297470) upto: 0.300000 0.000000 0.300000 ( 0.302154) downto: 0.310000 0.000000 0.310000 ( 0.305562) [/cc] 一次完整运行（ n=10~10^8 ）的数据结果如下： [cc lang=”bash”] n=10 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.000018) times: 0.000000 0.000000 0.000000 ( 0.000011) upto: 0.000000 0.000000 0.000000 ( 0.000047) downto: 0.000000 0.000000 0.000000 ( 0.000053) ———————————- total: 0.000000sec user system total real for: 0.000000 0.000000 0.000000 ( 0.000014) times: 0.000000 0.000000 0.000000 ( 0.000011) upto: 0.000000 0.000000 0.000000 ( 0.000011) downto: 0.000000 0.000000 0.000000 ( 0.000011) ===================================================== n=100 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.000041) times: 0.000000 0.000000 0.000000 ( 0.000031) upto: 0.000000 0.000000 0.000000 ( 0.000033) downto: 0.000000 0.000000 0.000000 ( 0.000040) ———————————- total: 0.000000sec user system total real for: 0.000000 0.000000 0.000000 ( 0.000035) times: 0.000000 0.000000 0.000000 ( 0.000030) upto: 0.000000 0.000000 0.000000 ( 0.000031) downto: 0.000000 0.000000 0.000000 ( 0.000031) ===================================================== n=1000 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.000367) times: 0.000000 0.000000 0.000000 ( 0.000315) upto: 0.000000 0.000000 0.000000 ( 0.000319) downto: 0.000000 0.000000 0.000000 ( 0.000854) ———————————- total: 0.000000sec user system total real for: 0.000000 0.000000 0.000000 ( 0.000273) times: 0.000000 0.000000 0.000000 ( 0.000250) upto: 0.000000 0.000000 0.000000 ( 0.000254) downto: 0.000000 0.000000 0.000000 ( 0.000258) ===================================================== n=10000 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.003388) times: 0.010000 0.000000 0.010000 ( 0.003056) upto: 0.000000 0.000000 0.000000 ( 0.003006) downto: 0.000000 0.000000 0.000000 ( 0.003084) ———————————- total: 0.010000sec user system total real for: 0.010000 0.000000 0.010000 ( 0.003114) times: 0.000000 0.000000 0.000000 ( 0.002955) upto: 0.000000 0.000000 0.000000 ( 0.003047) downto: 0.010000 0.000000 0.010000 ( 0.004650) ===================================================== n=100000 Rehearsal ——————————————- for: 0.030000 0.000000 0.030000 ( 0.032892) times: 0.030000 0.000000 0.030000 ( 0.029808) upto: 0.030000 0.000000 0.030000 ( 0.031190) downto: 0.030000 0.000000 0.030000 ( 0.030379) ———————————- total: 0.120000sec user system total real for: 0.030000 0.000000 0.030000 ( 0.033382) times: 0.030000 0.000000 0.030000 ( 0.029139) upto: 0.030000 0.000000 0.030000 ( 0.031608) downto: 0.030000 0.000000 0.030000 ( 0.030498) ===================================================== n=1000000 Rehearsal ——————————————- for: 0.310000 0.000000 0.310000 ( 0.313392) times: 0.290000 0.000000 0.290000 ( 0.297268) upto: 0.300000 0.000000 0.300000 ( 0.300311) downto: 0.310000 0.000000 0.310000 ( 0.304146) ———————————- total: 1.210000sec user system total real for: 0.310000 0.000000 0.310000 ( 0.313129) times: 0.290000 0.000000 0.290000 ( 0.297470) upto: 0.300000 0.000000 0.300000 ( 0.302154) downto: 0.310000 0.000000 0.310000 ( 0.305562) ===================================================== n=10000000 Rehearsal ——————————————- for: 3.090000 0.000000 3.090000 ( 3.109693) times: 2.940000 0.010000 2.950000 ( 2.946662) upto: 2.990000 0.010000 3.000000 ( 3.003812) downto: 3.010000 0.000000 3.010000 ( 3.021900) ——————————— total: 12.050000sec user system total real for: 3.110000 0.010000 3.120000 ( 3.119928) times: 2.950000 0.010000 2.960000 ( 2.992141) upto: 3.000000 0.010000 3.010000 ( 3.044853) downto: 3.020000 0.000000 3.020000 ( 3.036987) ===================================================== n=100000000 Rehearsal ——————————————- for: 30.950000 0.070000 31.020000 ( 31.139756) times: 29.360000 0.060000 29.420000 ( 29.543839) upto: 29.890000 0.070000 29.960000 ( 30.102346) downto: 30.080000 0.070000 30.150000 ( 30.271642) ——————————– total: 120.550000sec user system total real for: 31.130000 0.080000 31.210000 ( 31.359814) times: 29.420000 0.050000 29.470000 ( 29.630556) upto: 30.050000 0.060000 30.110000 ( 30.197589) downto: 30.180000 0.050000 30.230000 ( 30.361343) ===================================================== [/cc] 由于精力有限，就不做多次运行取平均值这种相对无聊的事情了，结果虽然不严谨也无法真正判断出究竟谁最快（times和upto，downto是在伯仲之间），但至少可以看出for in range是相对最慢的。 换ruby1.9后的运行结果与上基本一致，详细数据如下： [cc lang=”bash”] n=10 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.000029) times: 0.000000 0.000000 0.000000 ( 0.000050) upto: 0.000000 0.000000 0.000000 ( 0.000014) downto: 0.000000 0.000000 0.000000 ( 0.000013) ———————————- total: 0.000000sec user system total real for: 0.000000 0.000000 0.000000 ( 0.000014) times: 0.000000 0.000000 0.000000 ( 0.000011) upto: 0.000000 0.000000 0.000000 ( 0.000012) downto: 0.000000 0.000000 0.000000 ( 0.000012) ===================================================== n=100 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.000061) times: 0.000000 0.000000 0.000000 ( 0.000103) upto: 0.000000 0.000000 0.000000 ( 0.000078) downto: 0.000000 0.000000 0.000000 ( 0.000060) ———————————- total: 0.000000sec user system total real for: 0.000000 0.000000 0.000000 ( 0.000066) times: 0.000000 0.000000 0.000000 ( 0.000061) upto: 0.000000 0.000000 0.000000 ( 0.000061) downto: 0.000000 0.000000 0.000000 ( 0.000061) ===================================================== n=1000 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.000465) times: 0.000000 0.000000 0.000000 ( 0.000461) upto: 0.000000 0.000000 0.000000 ( 0.000477) downto: 0.000000 0.000000 0.000000 ( 0.000428) ———————————- total: 0.000000sec user system total real for: 0.000000 0.000000 0.000000 ( 0.000388) times: 0.000000 0.000000 0.000000 ( 0.000339) upto: 0.000000 0.000000 0.000000 ( 0.000341) downto: 0.000000 0.000000 0.000000 ( 0.000339) ===================================================== n=10000 Rehearsal ——————————————- for: 0.000000 0.000000 0.000000 ( 0.004486) times: 0.010000 0.000000 0.010000 ( 0.003675) upto: 0.000000 0.000000 0.000000 ( 0.004407) downto: 0.000000 0.000000 0.000000 ( 0.004121) ———————————- total: 0.010000sec user system total real for: 0.010000 0.000000 0.010000 ( 0.003961) times: 0.000000 0.000000 0.000000 ( 0.005113) upto: 0.010000 0.000000 0.010000 ( 0.003592) downto: 0.000000 0.000000 0.000000 ( 0.003592) ===================================================== n=100000 Rehearsal ——————————————- for: 0.040000 0.000000 0.040000 ( 0.042573) times: 0.030000 0.000000 0.030000 ( 0.039094) upto: 0.030000 0.000000 0.030000 ( 0.041495) downto: 0.040000 0.000000 0.040000 ( 0.049316) ———————————- total: 0.140000sec user system total real for: 0.040000 0.000000 0.040000 ( 0.040422) times: 0.040000 0.000000 0.040000 ( 0.037030) upto: 0.040000 0.000000 0.040000 ( 0.041921) downto: 0.040000 0.000000 0.040000 ( 0.039868) ===================================================== n=1000000 Rehearsal ——————————————- for: 0.390000 0.000000 0.390000 ( 0.401887) times: 0.370000 0.000000 0.370000 ( 0.376656) upto: 0.370000 0.010000 0.380000 ( 0.384750) downto: 0.370000 0.000000 0.370000 ( 0.380184) ———————————- total: 1.510000sec user system total real for: 0.400000 0.000000 0.400000 ( 0.411929) times: 0.370000 0.000000 0.370000 ( 0.386443) upto: 0.370000 0.010000 0.380000 ( 0.379820) downto: 0.370000 0.000000 0.370000 ( 0.379068) ===================================================== n=10000000 Rehearsal ——————————————- for: 3.920000 0.020000 3.940000 ( 4.021434) times: 3.690000 0.030000 3.720000 ( 3.844118) upto: 3.710000 0.030000 3.740000 ( 3.844035) downto: 3.700000 0.020000 3.720000 ( 3.795330) ——————————— total: 15.120000sec user system total real for: 3.910000 0.020000 3.930000 ( 4.003016) times: 3.670000 0.020000 3.690000 ( 3.749495) upto: 3.700000 0.020000 3.720000 ( 3.919785) downto: 3.690000 0.030000 3.720000 ( 3.789975) ===================================================== n=100000000 Rehearsal ——————————————- for: 39.260000 0.240000 39.500000 ( 40.293460) times: 36.700000 0.210000 36.910000 ( 37.450910) upto: 37.020000 0.260000 37.280000 ( 38.963391) downto: 36.940000 0.230000 37.170000 ( 37.806189) ——————————– total: 150.860000sec user system total real for: 39.230000 0.240000 39.470000 ( 40.471694) times: 36.850000 0.240000 37.090000 ( 38.302817) upto: 36.870000 0.230000 37.100000 ( 37.802815) downto: 36.970000 0.220000 37.190000 ( 38.052300) ===================================================== [/cc] 有趣的是ruby1.9的循环操作性能竟然普遍都是负增长，这倒为我们之后的list performance比较埋下了伏笔。 热身运动到此结束，似乎有喧宾夺主之嫌，所以赶紧搞个part 2…，下篇文章我们会用上面循环性能测试的疑似最佳表现者times来进行list append性能测试，敬请期待。</p>

      
    </div>

    

    
    
    

    

    
       
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Buy me a coffee</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Samson Wu WeChat Pay">
        <p>WeChat Pay</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    
      <div>
        



  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Samson Wu</li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    
    <a href="/1621.html" title="List performance: ruby 1.8 and 1.9 (Part 1)">1621.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Ruby/" rel="tag"># Ruby</a>
          
            <a href="/tags/Performance/" rel="tag"># Performance</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2010/02/21/update-29/" rel="next" title="Update-29">
                <i class="fa fa-chevron-left"></i> Update-29
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2010/02/22/list-performance-ruby-1-8-and-1-9-part-2/" rel="prev" title=" List performance: ruby 1.8 and 1.9 (Part 2)">
                 List performance: ruby 1.8 and 1.9 (Part 2) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MTM2Ny8xNzkxNA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/cartoon_photo.jpg" alt="Samson Wu">
            
              <p class="site-author-name" itemprop="name">Samson Wu</p>
              <p class="site-description motion-element" itemprop="description">天与弗取，反受其咎；时至不行，反受其殃</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">347</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">148</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">140</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/samsonw" title="GitHub &rarr; https://github.com/samsonw" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://samsonw.info" title="http://samsonw.info" rel="noopener" target="_blank">Portfolio</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://resume.samsonw.info" title="http://resume.samsonw.info" rel="noopener" target="_blank">Resume</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2007 – <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Samson Wu</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="Symbols count total">309k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="Reading time total">8:35</span>
  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  
    <script type="text/javascript">
      window.livereOptions = {
        refer: '2010/02/22/list-performance-ruby-1-8-and-1-9-part-1/'
      };
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  










  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  
  

  

  

  

  

  

  

</body>
</html>
